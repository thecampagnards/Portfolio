(function(d){Modernizr.addTest("csstransformspreserve3d",function(){var i=Modernizr.prefixed("transformStyle");var h="preserve-3d";var g;if(!i){return false}i=i.replace(/([A-Z])/g,function(k,j){return"-"+j.toLowerCase()}).replace(/^ms-/,"-ms-");Modernizr.testStyles("#modernizr{"+i+":"+h+";}",function(j,k){g=d.getComputedStyle?getComputedStyle(j,null).getPropertyValue(i):""});return(g===h)});function f(h,g){for(var i in g){if(g.hasOwnProperty(i)){h[i]=g[i]}}return h}var c={transitions:Modernizr.csstransitions,transforms3d:Modernizr.csstransforms3d&&Modernizr.csstransformspreserve3d},b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},e=b[Modernizr.prefixed("transition")];function a(h,g){this.button=h;this.options=f({},this.options);f(this.options,g);this._init()}a.prototype.options={statusTime:1500};a.prototype._init=function(){this._validate();this._create();this._initEvents()};a.prototype._validate=function(){if(this.button.getAttribute("data-style")===null){this.button.setAttribute("data-style","fill")}if(this.button.getAttribute("data-vertical")===null&&this.button.getAttribute("data-horizontal")===null){this.button.setAttribute("data-horizontal","")}if(!c.transforms3d&&this.button.getAttribute("data-perspective")!==null){this.button.removeAttribute("data-perspective");this.button.setAttribute("data-style","fill");this.button.removeAttribute("data-vertical");this.button.setAttribute("data-horizontal","")}};a.prototype._create=function(){var j=document.createElement("span");j.className="content";j.innerHTML=this.button.innerHTML;var h=document.createElement("span");h.className="progress";var i=document.createElement("span");i.className="progress-inner";h.appendChild(i);this.button.innerHTML="";if(this.button.getAttribute("data-perspective")!==null){var g=document.createElement("span");g.className="progress-wrap";g.appendChild(j);g.appendChild(h);this.button.appendChild(g)}else{this.button.appendChild(j);this.button.appendChild(h)}this.progress=i;if(this.button.getAttribute("data-horizontal")!==null){this.progressProp="width"}else{if(this.button.getAttribute("data-vertical")!==null){this.progressProp="height"}}this._enable()};a.prototype._setProgress=function(g){this.progress.style[this.progressProp]=100*g+"%"};a.prototype._initEvents=function(){var g=this;this.button.addEventListener("click",function(){g.button.setAttribute("enable","");classie.remove(g.progress,"notransition");classie.add(this,"state-loading");setTimeout(function(){if(typeof g.options.callback==="function"){g.options.callback(g)}else{g._setProgress(1);var h=function(i){if(c.transitions&&i.propertyName!==g.progressProp){return}this.removeEventListener(e,h);g._stop()};if(c.transitions){g.progress.addEventListener(e,h)}else{h.call()}}},g.button.getAttribute("data-style")==="fill"||g.button.getAttribute("data-style")==="top-line"||g.button.getAttribute("data-style")==="lateral-lines"?0:200)})};a.prototype._stop=function(g){var h=this;setTimeout(function(){h.progress.style.opacity=0;var j=function(k){if(c.transitions&&k.propertyName!=="opacity"){return}this.removeEventListener(e,j);classie.add(h.progress,"notransition");h.progress.style[h.progressProp]="0%";h.progress.style.opacity=1};if(c.transitions){h.progress.addEventListener(e,j)}else{j.call()}if(typeof g==="number"){var i=g>=0?"state-success":"state-error";classie.add(h.button,i);setTimeout(function(){classie.remove(h.button,i);h._enable()},h.options.statusTime)}else{h._enable()}classie.remove(h.button,"state-loading")},100)};a.prototype._enable=function(){this.button.removeAttribute("disabled")};d.ProgressButton=a})(window);